---
title: 图生图简单案例
toc: content
order: 1
group:
  title: 实战
---

# ComfyUI 实战：生成「瓶中紫银河」风景图像

## 🎯 项目概述

本实战通过 ComfyUI 可视化工作流，实现**玻璃瓶装着紫色银河的自然风景图像**生成。全程使用`dreamshaper_8`模型，结合文本提示词引导、K 采样器降噪渲染，最终输出 512×512 像素的高质量图像。

---

## 🛠️ 环境准备

1. **软件基础**：已安装 ComfyUI（建议搭配 Python 3.10+环境）
2. **模型资源**：下载`dreamshaper_8-全能.safetensors`模型，放置于 ComfyUI 的`models/checkpoints`目录
3. **依赖验证**：确保 ComfyUI 启动时无报错，CLIP、VAE 组件自动加载正常

---

![图片](/comfyui-doc/practical/image.png)

[下载示例文件(JSON)](/practical/textToImg01.json)

## 🧩 工作流节点详解

### 1. Checkpoint 加载器（简易）

- **核心作用**：加载 Stable Diffusion 主模型，输出模型、CLIP 文本编码器、VAE 解码器三个核心组件
- **参数配置**：选择模型为`dreamshaper_8-全能.safetensors`
- **连接逻辑**：
  - `模型`输出 → K 采样器的`模型`输入
  - `CLIP`输出 → 两个 CLIP 文本编码节点的`clip`输入
  - `VAE`输出 → VAE 解码节点的`vae`输入

### 2. CLIP 文本编码（正面提示词）

- **核心作用**：将正向文本描述转换为模型可理解的条件向量，引导图像生成方向
- **提示词配置**：
  ```
  beautiful scenery nature glass bottle landscape, purple galaxy bottle, masterpiece, best quality, realistic
  ```
- **连接逻辑**：`条件`输出 → K 采样器的`正面条件`输入

### 3. CLIP 文本编码（负面提示词）

- **核心作用**：定义需要排除的元素，避免生成低质量或冗余内容
- **提示词配置**：
  ```
  text, watermark, low quality, blurry, ugly, lowres
  ```
- **连接逻辑**：`条件`输出 → K 采样器的`负面条件`输入

### 4. 空 Latent 图像

- **核心作用**：生成初始潜在图像张量（模型内部的“草稿画布”）
- **参数配置**：宽度`512`、高度`512`、批量大小`1`
- **连接逻辑**：`Latent`输出 → K 采样器的`Latent图像`输入

### 5. K 采样器

- **核心作用**：基于模型和文本条件，对潜在图像进行降噪迭代，生成最终潜在特征
- **关键参数**：
  | 参数名 | 配置值 | 作用说明 |
  |--------------|-----------|------------------------------|
  | 种子 | 66666 | 固定种子可重复生成相同图像 |
  | 生成后控制 | fixed | 保持生成后尺寸不变 |
  | 步数 | 20 | 降噪迭代次数，平衡速度与质量 |
  | cfg | 8.0 | 提示词影响力强度（8-10 常用） |
  | 采样器名称 | dpmpp_2m | 高效采样器，适合快速出图 |
  | 调度器 | karras | 优化采样步骤，提升细节表现 |
  | 降噪 | 1.0 | 完全生成新图像（图生图可降低） |
- **连接逻辑**：`Latent`输出 → VAE 解码节点的`Latent`输入

### 6. VAE 解码

- **核心作用**：将潜在特征张量解码为可视化图像
- **连接逻辑**：`图像`输出 → 保存图像节点的`图片`输入

### 7. 保存图像

- **核心作用**：将生成的图像保存到本地，并提供实时预览
- **参数配置**：文件名前缀`ComfyUI`（图像默认保存至`ComfyUI/output`目录）

---

## 🚀 完整操作步骤

### 步骤 1：启动 ComfyUI

运行`python main.py`启动服务，在浏览器打开`http://localhost:8188`进入界面。

### 步骤 2：搭建/加载工作流

- 手动搭建：从节点面板拖拽上述所有节点，按“连接逻辑”完成连线
- 快速加载：导入本工作流的 JSON 配置（需提前导出）

### 步骤 3：配置提示词与参数

- 正面提示词：补充细节（如添加`cinematic lighting, vibrant colors, wooden table`）
- 负面提示词：增强排除规则（如添加`bad anatomy, error, extra limbs`）
- 采样参数：保持默认配置，或根据需求微调（如尝试`dpmpp_sde_karras`采样器）

### 步骤 4：执行生成

点击界面底部的`Queue Prompt`按钮，等待采样、解码完成。生成的图像会自动保存，同时在“保存图像”节点右侧预览。

---

## 💡 参数优化建议

1. **提示词进阶**：用权重语法强化关键词，如`(purple galaxy bottle:1.2)`提升瓶子和银河的视觉占比
2. **分辨率升级**：尝试 768×768 尺寸（需显存 ≥8GB），配合`HighResFix`节点提升细节
3. **采样器切换**：艺术感需求选`euler_a`，细腻细节选`dpmpp_sde_karras`
4. **显存优化**：启用 xformers 加速（启动命令加`--xformers`），或降低批量大小至 1

---

## ❗ 常见问题排查

- **模型加载失败**：检查模型路径是否正确，文件是否为`safetensors`格式（避免损坏）
- **图像模糊/偏色**：增加采样步数（如 30 步），提升 CFG 值至 9-10，或更换调度器为`exponential`
- **提示词不生效**：确认 CLIP 节点连线正常，提示词用逗号分隔关键词，避免中英文混排
- **显存溢出**：降低图像尺寸至 384×384，关闭其他占用显存的程序

---
